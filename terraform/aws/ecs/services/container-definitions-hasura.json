[
  {
    "volumesFrom": [],
    "memory": ${hasura_memory_credits},
    "extraHosts": null,
    "dnsServers": null,
    "disableNetworking": null,
    "dnsSearchDomains": null,
    "portMappings": [
      {
        "hostPort": 8080,
        "containerPort": 8080,
        "protocol": "tcp"
      }
    ],
    "hostname": null,
    "essential": true,
    "entryPoint": [],
    "mountPoints": [],
    "name": "hasura",
    "ulimits": null,
    "dockerSecurityOptions": null,
    "environment": [
      { "name": "HASURA_GRAPHQL_UNAUTHORIZED_ROLE",     "value": "anonymous" },
      { "name": "HASURA_GRAPHQL_METADATA_DATABASE_URL", "value": "postgres://${pg_username}:${pg_password}@${pg_host}:${pg_port}/${pg_dbname}" },
      { "name": "HASURA_GRAPHQL_ENABLED_LOG_TYPES",     "value": "startup, http-log, webhook-log, websocket-log, query-log" },
      { "name": "HASURA_GRAPHQL_DATABASE_URL",          "value": "postgres://${pg_username}:${pg_password}@${pg_host}:${pg_port}/${pg_dbname}" },
      { "name": "HASURA_GRAPHQL_READ_REPLICA_URLS",     "value": "${pg_replica_uris}" },
      { "name": "HASURA_GRAPHQL_PUBLIC_SCHEMA_NAME",    "value": "${pg_transform_schema}" },
      { "name": "HASURA_GRAPHQL_ENABLE_CONSOLE",        "value": "${hasura_enable_console}" },
      { "name": "HASURA_GRAPHQL_DEV_MODE",              "value": "${hasura_enable_dev_mode}" },
      { "name": "HASURA_GRAPHQL_ADMIN_SECRET",          "value": "${hasura_admin_secret}" },
      { "name": "HASURA_GRAPHQL_JWT_SECRET",            "value": ${jsonencode(hasura_jwt_secret)} },
      { "name": "AWS_LAMBDA_API_GATEWAY_ENDPOINT",      "value": "${aws_lambda_api_gateway_endpoint}" }
    ],
    "links": [],
    "workingDirectory": null,
    "readonlyRootFilesystem": null,
    "image": "${hasura_image}",
    "command": [],
    "user": null,
    "dockerLabels": null,
    "cpu": ${hasura_cpu_credits},
    "privileged": null,
    "memoryReservation": null,
    "healthCheck": {
      "command": [ "CMD-SHELL", "pytest tests/test_smoke.py || exit 1" ],
      "interval": ${hasura_healthcheck_interval},
      "retries": ${hasura_healthcheck_retries}
    },
    "logConfiguration": {
      "logDriver": "awslogs",
      "options": {
        "awslogs-group": "${aws_log_group_name}",
        "awslogs-region": "${aws_log_region}",
        "awslogs-stream-prefix": "hasura"
      }
    }
  }
]
