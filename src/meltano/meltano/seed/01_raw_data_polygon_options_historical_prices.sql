create table if not exists raw_data.polygon_options_historical_prices
(
    _sdc_batched_at   timestamp,
    _sdc_deleted_at   varchar,
    _sdc_extracted_at timestamp,
    c                 double precision,
    contract_name     varchar not null,
    h                 double precision,
    l                 double precision,
    n                 numeric,
    o                 double precision,
    t                 numeric not null,
    v                 numeric,
    vw                double precision,
    primary key (t, contract_name)
);


insert into raw_data.polygon_options_historical_prices (_sdc_batched_at, _sdc_deleted_at, _sdc_extracted_at, c, contract_name, h, l, n, o, t, v, vw)
values  ('2022-05-05 08:20:41.271614', null, '2022-05-05 08:20:41.267194', 32.8, 'AAPL240621P00160000', 32.8, 31.5, 3, 31.68, 1647230400000, 3, 31.9933),
        ('2022-05-05 08:20:41.272283', null, '2022-05-05 08:20:41.268594', 29.15, 'AAPL240621P00160000', 29.15, 29.15, 1, 29.15, 1647316800000, 1, 29.15),
        ('2022-05-05 08:20:41.272585', null, '2022-05-05 08:20:41.269255', 27.47, 'AAPL240621P00160000', 27.53, 25.9, 5, 25.9, 1647403200000, 9, 27.3056),
        ('2022-05-05 08:20:41.272860', null, '2022-05-05 08:20:41.269897', 27.17, 'AAPL240621P00160000', 27.73, 27.17, 5, 27.4, 1647489600000, 8, 27.3225),
        ('2022-05-05 08:20:41.273138', null, '2022-05-05 08:20:41.270378', 25.9, 'AAPL240621P00160000', 26.77, 25.57, 4, 26.16, 1647576000000, 43, 26.0374),
        ('2022-05-05 08:20:41.273400', null, '2022-05-05 08:20:41.270806', 24.85, 'AAPL240621P00160000', 24.99, 24.75, 6, 24.99, 1647835200000, 13, 24.95),
        ('2022-05-05 08:20:41.273715', null, '2022-05-05 08:20:41.271268', 22.3, 'AAPL240621P00160000', 23.4, 22.3, 5, 23.4, 1647921600000, 49, 23.0518),
        ('2022-05-05 08:20:41.280609', null, '2022-05-05 08:20:41.271702', 22.1, 'AAPL240621P00160000', 22.1, 22, 2, 22, 1648008000000, 11, 22.0909),
        ('2022-05-05 08:20:41.281070', null, '2022-05-05 08:20:41.272141', 21.5, 'AAPL240621P00160000', 22.53, 21.5, 2, 22.53, 1648094400000, 3, 21.8433),
        ('2022-05-05 08:20:41.281367', null, '2022-05-05 08:20:41.272593', 21.33, 'AAPL240621P00160000', 21.33, 21.33, 1, 21.33, 1648180800000, 1, 21.33),
        ('2022-05-05 08:20:41.281636', null, '2022-05-05 08:20:41.273034', 20.95, 'AAPL240621P00160000', 21.03, 20.95, 3, 21.03, 1648440000000, 7, 21.0014),
        ('2022-05-05 08:20:41.281899', null, '2022-05-05 08:20:41.273488', 19.35, 'AAPL240621P00160000', 19.35, 19.35, 1, 19.35, 1648526400000, 40, 19.35),
        ('2022-05-05 08:20:41.282198', null, '2022-05-05 08:20:41.273922', 20.15, 'AAPL240621P00160000', 20.15, 19, 5, 19, 1648612800000, 21, 19.1762),
        ('2022-05-05 08:20:41.282486', null, '2022-05-05 08:20:41.274369', 20.5, 'AAPL240621P00160000', 20.5, 20.2, 2, 20.2, 1648785600000, 7, 20.4143),
        ('2022-05-05 08:20:41.282790', null, '2022-05-05 08:20:41.274799', 19.1, 'AAPL240621P00160000', 19.2, 19.1, 4, 19.2, 1649044800000, 16, 19.175),
        ('2022-05-05 08:20:41.283047', null, '2022-05-05 08:20:41.275262', 19.25, 'AAPL240621P00160000', 19.25, 19.25, 1, 19.25, 1649131200000, 10, 19.25),
        ('2022-05-05 08:20:41.283321', null, '2022-05-05 08:20:41.275725', 21.44, 'AAPL240621P00160000', 21.95, 21.1, 4, 21.1, 1649217600000, 5, 21.426),
        ('2022-05-05 08:20:41.283580', null, '2022-05-05 08:20:41.276177', 22, 'AAPL240621P00160000', 22.64, 21.95, 17, 22.64, 1649390400000, 182, 22.0032),
        ('2022-05-05 08:20:41.283994', null, '2022-05-05 08:20:41.276617', 23, 'AAPL240621P00160000', 23, 22.67, 2, 22.67, 1649736000000, 151, 22.9978),
        ('2022-05-05 08:20:41.284512', null, '2022-05-05 08:20:41.277042', 22.4, 'AAPL240621P00160000', 22.4, 22.4, 1, 22.4, 1649822400000, 21, 22.4),
        ('2022-05-05 08:20:41.284826', null, '2022-05-05 08:20:41.277503', 23.47, 'AAPL240621P00160000', 23.47, 23.08, 2, 23.08, 1649908800000, 9, 23.4267),
        ('2022-05-05 08:20:41.285100', null, '2022-05-05 08:20:41.277930', 23.25, 'AAPL240621P00160000', 23.45, 22.94, 4, 23.45, 1650254400000, 1787, 23.3942),
        ('2022-05-05 08:20:41.285381', null, '2022-05-05 08:20:41.278362', 22, 'AAPL240621P00160000', 22, 22, 1, 22, 1650427200000, 1, 22),
        ('2022-05-05 08:20:41.285646', null, '2022-05-05 08:20:41.278770', 21.6, 'AAPL240621P00160000', 21.6, 21.6, 1, 21.6, 1650513600000, 1, 21.6),
        ('2022-05-05 08:20:41.286053', null, '2022-05-05 08:20:41.280741', 25.15, 'AAPL240621P00160000', 25.15, 24.29, 3, 24.29, 1650600000000, 89, 25.0055),
        ('2022-05-05 08:20:41.286338', null, '2022-05-05 08:20:41.281323', 25, 'AAPL240621P00160000', 26.59, 25, 5, 26.59, 1650859200000, 6, 25.765),
        ('2022-05-05 08:20:41.286606', null, '2022-05-05 08:20:41.281751', 27.35, 'AAPL240621P00160000', 27.35, 27.35, 1, 27.35, 1650945600000, 1, 27.35),
        ('2022-05-05 08:20:41.286867', null, '2022-05-05 08:20:41.282567', 26.66, 'AAPL240621P00160000', 27, 26.66, 6, 27, 1651032000000, 22, 26.7545),
        ('2022-05-05 08:20:41.287181', null, '2022-05-05 08:20:41.283481', 24, 'AAPL240621P00160000', 25.85, 24, 8, 25.85, 1651118400000, 61, 24.4918),
        ('2022-05-05 08:20:41.287441', null, '2022-05-05 08:20:41.284028', 25.9, 'AAPL240621P00160000', 25.9, 23.57, 8, 23.57, 1651204800000, 37, 25.2581),
        ('2022-05-05 08:20:41.287706', null, '2022-05-05 08:20:41.284519', 28.08, 'AAPL240621P00160000', 28.08, 27.45, 4, 27.45, 1651464000000, 8, 27.6663),
        ('2022-05-05 08:20:41.288304', null, '2022-05-05 08:20:41.284985', 25.85, 'AAPL240621P00160000', 25.85, 25.85, 1, 25.85, 1651550400000, 1, 25.85),
        ('2022-05-05 08:20:41.288692', null, '2022-05-05 08:20:41.285464', 23.15, 'AAPL240621P00160000', 24.65, 23.15, 2, 24.65, 1651636800000, 201, 23.1575),
        ('2022-05-05 08:31:35.969761', null, '2022-05-05 08:31:35.965338', 11.2, 'AAPL240621C00225000', 11.2, 11.2, 1, 11.2, 1646974800000, 20, 11.2),
        ('2022-05-05 08:31:35.970332', null, '2022-05-05 08:31:35.966544', 9.57, 'AAPL240621C00225000', 11, 9.57, 7, 10, 1647230400000, 55, 10.2804),
        ('2022-05-05 08:31:35.970605', null, '2022-05-05 08:31:35.967063', 9.57, 'AAPL240621C00225000', 9.57, 9.57, 1, 9.57, 1647316800000, 1, 9.57),
        ('2022-05-05 08:31:35.970851', null, '2022-05-05 08:31:35.967556', 10.55, 'AAPL240621C00225000', 10.55, 10, 2, 10, 1647403200000, 3, 10.3667),
        ('2022-05-05 08:31:35.971094', null, '2022-05-05 08:31:35.968011', 12.4, 'AAPL240621C00225000', 12.4, 11.47, 4, 11.47, 1647489600000, 37, 11.5116),
        ('2022-05-05 08:31:35.971334', null, '2022-05-05 08:31:35.968491', 11.52, 'AAPL240621C00225000', 11.52, 11.52, 1, 11.52, 1647576000000, 12, 11.52),
        ('2022-05-05 08:31:35.971590', null, '2022-05-05 08:31:35.968942', 16.33, 'AAPL240621C00225000', 16.33, 15.2, 2, 15.2, 1648008000000, 5, 16.104),
        ('2022-05-05 08:31:35.971874', null, '2022-05-05 08:31:35.969391', 17.3, 'AAPL240621C00225000', 17.3, 16.5, 12, 16.74, 1648094400000, 1044, 16.7383),
        ('2022-05-05 08:31:35.972115', null, '2022-05-05 08:31:35.969896', 18, 'AAPL240621C00225000', 18.55, 17.15, 34, 17.36, 1648180800000, 1175, 18.0361),
        ('2022-05-05 08:31:35.972352', null, '2022-05-05 08:31:35.970350', 17.8, 'AAPL240621C00225000', 17.85, 17.25, 5, 17.25, 1648440000000, 29, 17.7466),
        ('2022-05-05 08:31:35.972609', null, '2022-05-05 08:31:35.970819', 18.97, 'AAPL240621C00225000', 18.97, 18.6, 7, 18.66, 1648526400000, 28, 18.8821),
        ('2022-05-05 08:31:35.972881', null, '2022-05-05 08:31:35.971251', 18.7, 'AAPL240621C00225000', 18.8, 18.7, 4, 18.75, 1648612800000, 4, 18.75),
        ('2022-05-05 08:31:35.973125', null, '2022-05-05 08:31:35.971687', 18.2, 'AAPL240621C00225000', 18.2, 18.05, 2, 18.05, 1648699200000, 2, 18.125),
        ('2022-05-05 08:31:35.973408', null, '2022-05-05 08:31:35.972127', 16, 'AAPL240621C00225000', 17, 16, 3, 16.93, 1648785600000, 42, 16.9095),
        ('2022-05-05 08:31:35.973644', null, '2022-05-05 08:31:35.972552', 18, 'AAPL240621C00225000', 18, 17.67, 8, 17.67, 1649044800000, 21, 17.9843),
        ('2022-05-05 08:31:35.973909', null, '2022-05-05 08:31:35.972984', 16.83, 'AAPL240621C00225000', 17.2, 16.83, 2, 17.2, 1649131200000, 6, 16.8917),
        ('2022-05-05 08:31:35.974276', null, '2022-05-05 08:31:35.973423', 16.5, 'AAPL240621C00225000', 16.5, 16.15, 4, 16.27, 1649217600000, 6, 16.345),
        ('2022-05-05 08:31:35.974692', null, '2022-05-05 08:31:35.973850', 16.5, 'AAPL240621C00225000', 16.6, 16.5, 2, 16.6, 1649304000000, 16, 16.5063),
        ('2022-05-05 08:31:35.975112', null, '2022-05-05 08:31:35.974272', 14.25, 'AAPL240621C00225000', 15, 14.25, 4, 15, 1649649600000, 9, 14.5722),
        ('2022-05-05 08:31:35.975538', null, '2022-05-05 08:31:35.974702', 15.1, 'AAPL240621C00225000', 15.1, 15.1, 1, 15.1, 1649822400000, 1, 15.1),
        ('2022-05-05 08:31:35.975963', null, '2022-05-05 08:31:35.975118', 14.5, 'AAPL240621C00225000', 14.5, 14.5, 1, 14.5, 1649908800000, 1, 14.5),
        ('2022-05-05 08:31:35.976377', null, '2022-05-05 08:31:35.975546', 13.1, 'AAPL240621C00225000', 13.82, 13.1, 3, 13.82, 1650254400000, 4, 13.305),
        ('2022-05-05 08:31:35.976792', null, '2022-05-05 08:31:35.975963', 13.89, 'AAPL240621C00225000', 14, 13.89, 2, 14, 1650340800000, 2, 13.945),
        ('2022-05-05 08:31:35.977210', null, '2022-05-05 08:31:35.976387', 13.79, 'AAPL240621C00225000', 13.79, 13.79, 1, 13.79, 1650427200000, 12, 13.79),
        ('2022-05-05 08:31:35.977662', null, '2022-05-05 08:31:35.976810', 14.4, 'AAPL240621C00225000', 14.4, 14.4, 1, 14.4, 1650600000000, 1, 14.4),
        ('2022-05-05 08:31:35.978119', null, '2022-05-05 08:31:35.977237', 11.8, 'AAPL240621C00225000', 12.5, 11.8, 4, 12.5, 1650945600000, 9, 12.2389),
        ('2022-05-05 08:31:35.978568', null, '2022-05-05 08:31:35.977705', 11.6, 'AAPL240621C00225000', 12.3, 11.4, 6, 12, 1651032000000, 34, 11.6691),
        ('2022-05-05 08:31:35.979008', null, '2022-05-05 08:31:35.978152', 13.25, 'AAPL240621C00225000', 13.5, 12.5, 9, 13, 1651118400000, 223, 13.4686),
        ('2022-05-05 08:31:35.979467', null, '2022-05-05 08:31:35.978609', 12.25, 'AAPL240621C00225000', 13.5, 12.25, 2, 13.5, 1651204800000, 14, 13.4107),
        ('2022-05-05 08:31:35.979920', null, '2022-05-05 08:31:35.979055', 11.6, 'AAPL240621C00225000', 11.6, 10.55, 6, 11.25, 1651464000000, 1127, 11.3639),
        ('2022-05-05 08:31:35.980348', null, '2022-05-05 08:31:35.979508', 11.6, 'AAPL240621C00225000', 11.6, 11.6, 1, 11.6, 1651550400000, 1, 11.6),
        ('2022-05-05 08:31:35.980837', null, '2022-05-05 08:31:35.979965', 12.7, 'AAPL240621C00225000', 12.7, 11.85, 4, 11.85, 1651636800000, 403, 12.0031)
on conflict do nothing;
