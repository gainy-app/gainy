version: 2

sources:
  - name: gainy
    description: Gainy in-house datasets such as collections, industries, interests, categories, etc
    schema: raw_data
    tables:
      - name: blog_article_priority
      - name: crypto_ticker_industries
      - name: gainy_custom_industries
      - name: gainy_ticker_custom_industries
      - name: gainy_collections
      - name: gainy_categories
      - name: gainy_interests
      - name: gainy_countries
      - name: auto_ticker_industries
      - name: exchanges
      - name: ticker_collections
      - name: ticker_collections_weights
      - name: ticker_override
      - name: ticker_search_alternative_names

  - name: eod
    description: Financial data from https://eodhistoricaldata.com/
    schema: raw_data
    tables:
      - name: eod_fundamentals
      - name: eod_dividends
      - name: eod_options
      - name: eod_historical_prices
      - name: eod_intraday_prices

  - name: polygon
    description: Financial data from https://polygon.io/
    schema: raw_data
    tables:
      - name: polygon_intraday_prices
      - name: polygon_marketstatus_upcoming
      - name: polygon_options_historical_prices
      - name: polygon_crypto_historical_prices
      - name: polygon_stock_splits

  - name: coingecko
    description: Crypto data from https://coingecko.com
    schema: raw_data
    tables:
      - name: coingecko_coin
      - name: coingecko_market_realtime

  - name: app
    description: Mobile App data, managed by hasura
    schema: app
    tables:
      - name: analytics_profiles
      - name: drivewealth_accounts
      - name: drivewealth_accounts_positions
      - name: drivewealth_autopilot_runs
      - name: drivewealth_funds
      - name: drivewealth_instruments
      - name: drivewealth_users
      - name: drivewealth_portfolio_statuses
      - name: drivewealth_portfolios
      - name: influencers
      - name: invitations
      - name: notifications
      - name: personalized_collection_sizes
      - name: personalized_ticker_collections
      - name: plaid_institutions
      - name: portfolio_securities
      - name: profile_categories
      - name: profile_collection_match_score
      - name: profile_favorite_collections
      - name: profile_holdings
      - name: profile_interests
      - name: profile_plaid_access_tokens
      - name: profile_portfolio_accounts
      - name: profile_portfolio_transactions
      - name: profile_ticker_match_score
      - name: profiles
      - name: subscriptions
      - name: trading_collection_versions

  - name: website
    description: Website data, managed by webflow integrations at gainy.app
    schema: raw_data
    tables:
      - name: blogs

models:
  - name: categories
    columns:
      - name: id
        tests:
          - unique
          - not_null
          - type:
              type: 'integer'
      - name: name
        tests:
          - not_null
          - type:
              type: 'text'
      - name: icon_url
        tests:
          - type:
              type: 'text'
      - name: collection_id
        tests:
          - unique
          # - not_null # temporary disabled as not all linked to collections
          - type:
              type: 'integer'


  - name: gainy_custom_industries
    columns:
      - name: id
        tests:
          - unique
          - not_null
          - type:
              type: 'integer'
      - name: name
        tests:
          - not_null
          - type:
              type: 'character varying'
      - name: collection_id
        tests:
          - unique
          # - not_null # temporary disabled as not all linked to collections
          - type:
              type: 'integer'

  - name: gainy_industries
    columns:
      - name: id
        tests:
          - unique
          - not_null
          - type:
              type: 'integer'
      - name: name
        tests:
          - not_null
          - type:
              type: 'character varying'
      - name: collection_id
        tests:
          - unique
          - type:
              type: 'integer'

  - name: historical_prices
    columns:
      - name: symbol
        tests:
          - not_null
          - type:
              type: 'character varying'
      - name: adjusted_close
        tests:
          - type:
              type: 'double precision'
      - name: close
        tests:
          - type:
              type: 'double precision'
      - name: date
        tests:
          - not_null
          - type:
              type: 'date'
      - name: high
        tests:
          - type:
              type: 'double precision'
      - name: low
        tests:
          - type:
              type: 'double precision'
      - name: open
        tests:
          - type:
              type: 'double precision'
      - name: volume
        tests:
          - type:
              type: 'numeric'

  - name: interests
    columns:
      - name: id
        tests:
          - unique
          - type:
              type: 'integer'
      - name: sort_order
        tests:
          - type:
              type: 'integer'
      - name: enabled
        tests:
          - type:
              type: 'character varying'
      - name: icon_url
        tests:
          - type:
              type: 'character varying'
      - name: name
        tests:
          - type:
              type: 'character varying'

  - name: interest_industries
    columns:
      - name: id
        tests:
          - unique
          - type:
              type: 'character varying'
      - name: interest_id
        tests:
          - not_null
          - type:
              type: 'integer'
      - name: industry_id
        tests:
          - not_null
          - type:
              type: 'integer'
      - name: updated_at
        tests:
          - not_null
          - type:
              type: 'timestamp with time zone'

  - name: collections
    columns:
      - name: id
        tests:
          - unique
          - type:
              type: 'integer'
      - name: name
        tests:
          - not_null
          - type:
              type: 'character varying'
      - name: description
        tests:
          - type:
              type: 'character varying'
      - name: enabled
        tests:
          - accepted_values:
              values: [ '0', '1' ]
          - type:
              type: 'character varying'
      - name: image_url
        tests:
          - type:
              type: 'character varying'
      - name: size
        tests:
          - type:
              type: 'integer'

  - name: ticker_categories
    columns:
      - name: category_id
        tests:
          - not_null
          - type:
              type: 'integer'
      - name: symbol
        tests:
          - not_null
          - type:
              type: 'character varying'
      - name: rank
        tests:
          - not_null
          - type:
              type: 'integer'

  - name: ticker_events
    columns:
      - name: symbol
        tests:
          - not_null
          - type:
              type: 'character varying'
      - name: date
        tests:
          - not_null
          - type:
              type: 'date'
      - name: timestamp
        tests:
          - not_null
          - type:
              type: 'timestamp with time zone'
      - name: type
        tests:
          - type:
              type: 'text'
      - name: description
        tests:
          - type:
              type: 'text'
      - name: created_at
        tests:
          - type:
              type: 'timestamp with time zone'

  - name: ticker_highlights
    columns:
      - name: symbol
        tests:
          - not_null
          - type:
              type: 'character varying'
      - name: highlight
        tests:
          - type:
              type: 'text'
      - name: created_at
        tests:
          - type:
              type: 'timestamp with time zone'

  - name: ticker_industries
    columns:
      - name: symbol
        tests:
          - not_null
          - type:
              type: 'character varying'
      - name: industry_id
        tests:
          - not_null
          - type:
              type: 'integer'

  - name: ticker_interests
    columns:
      - name: symbol
        tests:
          - not_null
          - type:
              type: 'character varying'
      - name: interest_id
        tests:
          - not_null
          - type:
              type: 'integer'
      - name: rank
        tests:
          - not_null
          - type:
              type: 'integer'

  - name: ticker_categories_continuous
    columns:
      - name: symbol
        tests:
          - not_null
          - type:
              type: 'character varying'
      - name: category_id
        tests:
          - not_null
          - type:
              type: 'integer'
      - name: sim_dif
        tests:
          - not_null
          - type:
              type: 'double precision'

  - name: ticker_risk_scores
    columns:
      - name: symbol
        tests:
          - not_null
          - type:
              type: 'text'
      - name: risk_score
        tests:
          - not_null
          - type:
              type: 'double precision'

  - name: tickers
    columns:
      - name: symbol
        tests:
          - not_null
          - unique
          - type:
              type: 'character varying'
      - name: type
        tests:
          - type:
              type: 'character varying'
      - name: name
        tests:
          - type:
              type: 'character varying'
      - name: description
        tests:
          - type:
              type: 'character varying'
      - name: phone
        tests:
          - type:
              type: 'character varying'
      - name: logo_url
        tests:
          - type:
              type: 'character varying'
      - name: web_url
        tests:
          - type:
              type: 'character varying'
      - name: ipo_date
        tests:
          - type:
              type: 'date'
      - name: sector
        tests:
          - type:
              type: 'character varying'
      - name: industry
        tests:
          - type:
              type: 'character varying'
      - name: gic_sector
        tests:
          - type:
              type: 'character varying'
      - name: gic_group
        tests:
          - type:
              type: 'character varying'
      - name: gic_industry
        tests:
          - type:
              type: 'character varying'
      - name: gic_sub_industry
        tests:
          - type:
              type: 'character varying'
      - name: country_name
        tests:
          - type:
              type: 'text'
      - name: updated_at
        tests:
          - type:
              type: 'timestamp without time zone'


  - name: ticker_search
    columns:
      - name: symbol
        tests:
          - not_null
          - unique
          - type:
              type: 'character varying'
      - name: name
        tests:
          - type:
              type: 'character varying'
      - name: alternative_name
        tests:
          - type:
              type: 'character varying'
      - name: description
        tests:
          - type:
              type: 'character varying'
      - name: tag_1
        tests:
          - type:
              type: 'ARRAY'
      - name: tag_2
        tests:
          - type:
              type: 'ARRAY'
      - name: daily_volume_avg
        tests:
          - not_null
          - type:
              type:  'real'

  - name: collection_search
    columns:
      - name: id
        tests:
          - not_null
          - unique
          - type:
              type: 'integer'
      - name: name
        tests:
          - type:
              type: 'character varying'
      - name: description
        tests:
          - type:
              type: 'character varying'
      - name: tag_1
        tests:
          - type:
              type: 'ARRAY'
      - name: tag_2
        tests:
          - type:
              type: 'ARRAY'
      - name: tag_3
        tests:
          - type:
              type: 'ARRAY'

  - name: historical_prices_aggregated
    columns:
      - name: symbol
        tests:
          - type:
              type: 'character varying'
      - name: period
        tests:
          - type:
              type: 'text'
      - name: datetime
        tests:
          - type:
              type: 'timestamp without time zone'
      - name: open
        tests:
          - type:
              type: 'double precision'
      - name: high
        tests:
          - type:
              type: 'double precision'
      - name: low
        tests:
          - type:
              type: 'double precision'
      - name: close
        tests:
          - type:
              type: 'double precision'
      - name: adjusted_close
        tests:
          - type:
              type: 'double precision'
      - name: volume
        tests:
          - type:
              type: 'double precision'

  - name: chart
    columns:
      - name: symbol
        tests:
          - type:
              type: 'character varying'
      - name: period
        tests:
          - type:
              type: 'character varying'
      - name: datetime
        tests:
          - type:
              type: 'timestamp without time zone'
      - name: open
        tests:
          - type:
              type: 'double precision'
      - name: high
        tests:
          - type:
              type: 'double precision'
      - name: low
        tests:
          - type:
              type: 'double precision'
      - name: close
        tests:
          - type:
              type: 'double precision'
      - name: adjusted_close
        tests:
          - type:
              type: 'double precision'
      - name: volume
        tests:
          - type:
              type: 'double precision'

  - name: analyst_ratings
    columns:
      - name: symbol
        tests:
          - type:
              type: 'text'
      - name: buy
        tests:
          - type:
              type: 'integer'
      - name: hold
        tests:
          - type:
              type: 'integer'
      - name: sell
        tests:
          - type:
              type: 'integer'
      - name: rating
        tests:
          - type:
              type: 'double precision'
      - name: strong_buy
        tests:
          - type:
              type: 'integer'
      - name: strong_sell
        tests:
          - type:
              type: 'integer'
      - name: target_price
        tests:
          - type:
              type: 'double precision'

  - name: ticker_metrics
    columns:
      - name: symbol
        tests:
          - type:
              type: 'character varying'
      - name: profit_margin
        tests:
          - type:
              type: 'double precision'
# trading
      - name: avg_volume_10d
        tests:
          - type:
              type: 'double precision'
      - name: short_percent_outstanding
        tests:
          - type:
              type: 'double precision'
      - name: shares_outstanding
        tests:
          - type:
              type: 'bigint'
      - name: avg_volume_90d
        tests:
          - type:
              type: 'double precision'
      - name: shares_float
        tests:
          - type:
              type: 'bigint'
      - name: short_ratio
        tests:
          - type:
              type: 'double precision'
      - name: short_percent
        tests:
          - type:
              type: 'double precision'
      - name: beta
        tests:
          - type:
              type: 'double precision'
      - name: absolute_historical_volatility_adjusted_current
        tests:
          - type:
              type: 'double precision'
      - name: relative_historical_volatility_adjusted_current
        tests:
          - type:
              type: 'double precision'
      - name: absolute_historical_volatility_adjusted_min_1y
        tests:
          - type:
              type: 'double precision'
      - name: absolute_historical_volatility_adjusted_max_1y
        tests:
          - type:
              type: 'double precision'
      - name: relative_historical_volatility_adjusted_min_1y
        tests:
          - type:
              type: 'double precision'
      - name: relative_historical_volatility_adjusted_max_1y
        tests:
          - type:
              type: 'double precision'
      - name: implied_volatility
        tests:
          - type:
              type: 'double precision'
# growth
      - name: revenue_growth_yoy
        tests:
          - type:
              type: 'double precision'
      - name: revenue_growth_fwd
        tests:
          - type:
              type: 'double precision'
      - name: ebitda_growth_yoy
        tests:
          - type:
              type: 'double precision'
      - name: eps_growth_yoy
        tests:
          - type:
              type: 'double precision'
      - name: eps_growth_fwd
        tests:
          - type:
              type: 'double precision'
# general
      - name: address_city
        tests:
          - type:
              type: 'character varying'
      - name: address_state
        tests:
          - type:
              type: 'character varying'
      - name: address_county
        tests:
          - type:
              type: 'character varying'
      - name: address_full
        tests:
          - type:
              type: 'character varying'
      - name: exchange_name
        tests:
          - type:
              type: 'character varying'
# valuation
      - name: market_capitalization
        tests:
          - type:
              type: 'bigint'
      - name: enterprise_value_to_sales
        tests:
          - type:
              type: 'double precision'
      - name: price_to_earnings_ttm
        tests:
          - type:
              type: 'double precision'
      - name: price_to_sales_ttm
        tests:
          - type:
              type: 'double precision'
      - name: price_to_book_value
        tests:
          - type:
              type: 'double precision'
      - name: enterprise_value_to_ebitda
        tests:
          - type:
              type: 'double precision'
# momentum
      - name: price_change_1m
        tests:
          - type:
              type: 'double precision'
      - name: price_change_3m
        tests:
          - type:
              type: 'double precision'
      - name: price_change_1y
        tests:
          - type:
              type: 'double precision'
# dividend
      - name: dividend_yield
        tests:
          - type:
              type: 'double precision'
      - name: dividends_per_share
        tests:
          - type:
              type: 'double precision'
      - name: dividend_payout_ratio
        tests:
          - type:
              type: 'double precision'
      - name: years_of_consecutive_dividend_growth
        tests:
          - type:
              type: 'integer'
      - name: dividend_frequency
        tests:
          - type:
              type: 'character varying'
# earnings
      - name: eps_ttm
        tests:
          - type:
              type: 'double precision'
      - name: eps_actual
        tests:
          - type:
              type: 'double precision'
      - name: eps_estimate
        tests:
          - type:
              type: 'double precision'
      - name: beaten_quarterly_eps_estimation_count_ttm
        tests:
          - type:
              type: 'integer'
      - name: eps_surprise
        tests:
          - type:
              type: 'double precision'
      - name: eps_difference
        tests:
          - type:
              type: 'double precision'
      - name: revenue_estimate_avg_0y
        tests:
          - type:
              type: 'double precision'
      - name: revenue_actual
        tests:
          - type:
              type: 'double precision'
      # financials
      - name: revenue_ttm
        tests:
          - type:
              type: 'double precision'
      - name: revenue_per_share_ttm
        tests:
          - type:
              type: 'double precision'
      - name: net_income
        tests:
          - type:
              type: 'double precision'
      - name: net_income_ttm
        tests:
          - type:
              type: 'double precision'
      - name: roi
        tests:
          - type:
              type: 'double precision'
      - name: asset_cash_and_equivalents
        tests:
          - type:
              type: 'double precision'
      - name: roa
        tests:
          - type:
              type: 'double precision'
      - name: total_assets
        tests:
          - type:
              type: 'double precision'
      - name: ebitda
        tests:
          - type:
              type: 'double precision'
      - name: ebitda_ttm
        tests:
          - type:
              type: 'double precision'
      - name: net_debt
        tests:
          - type:
              type: 'double precision'

  - name: portfolio_holding_gains
    columns:
      - name: holding_id
        tests:
          - type:
              type: 'text'
      - name: updated_at
        tests:
          - type:
              type: 'timestamp with time zone'
      - name: actual_value
        tests:
          - type:
              type: 'double precision'
      - name: value_to_portfolio_value
        tests:
          - type:
              type: 'double precision'
      - name: relative_gain_1d
        tests:
          - type:
              type: 'double precision'
      - name: relative_gain_1w
        tests:
          - type:
              type: 'double precision'
      - name: relative_gain_1m
        tests:
          - type:
              type: 'double precision'
      - name: relative_gain_3m
        tests:
          - type:
              type: 'double precision'
      - name: relative_gain_1y
        tests:
          - type:
              type: 'double precision'
      - name: relative_gain_5y
        tests:
          - type:
              type: 'double precision'
      - name: relative_gain_total
        tests:
          - type:
              type: 'double precision'
      - name: absolute_gain_1d
        tests:
          - type:
              type: 'double precision'
      - name: absolute_gain_1w
        tests:
          - type:
              type: 'double precision'
      - name: absolute_gain_1m
        tests:
          - type:
              type: 'double precision'
      - name: absolute_gain_3m
        tests:
          - type:
              type: 'double precision'
      - name: absolute_gain_1y
        tests:
          - type:
              type: 'double precision'
      - name: absolute_gain_5y
        tests:
          - type:
              type: 'double precision'
      - name: absolute_gain_total
        tests:
          - type:
              type: 'double precision'
      - name: ltt_quantity_total
        tests:
          - type:
              type: 'double precision'

  - name: portfolio_holding_group_gains
    columns:
      - name: id
        tests:
          - type:
              type: 'text'
      - name: profile_id
        tests:
          - type:
              type: 'integer'
      - name: ticker_symbol
        tests:
          - type:
              type: 'character varying'
      - name: updated_at
        tests:
          - type:
              type: 'timestamp with time zone'
      - name: actual_value
        tests:
          - type:
              type: 'double precision'
      - name: value_to_portfolio_value
        tests:
          - type:
              type: 'double precision'
      - name: relative_gain_1d
        tests:
          - type:
              type: 'double precision'
      - name: relative_gain_1w
        tests:
          - type:
              type: 'double precision'
      - name: relative_gain_1m
        tests:
          - type:
              type: 'double precision'
      - name: relative_gain_3m
        tests:
          - type:
              type: 'double precision'
      - name: relative_gain_1y
        tests:
          - type:
              type: 'double precision'
      - name: relative_gain_5y
        tests:
          - type:
              type: 'double precision'
      - name: relative_gain_total
        tests:
          - type:
              type: 'double precision'
      - name: absolute_gain_1d
        tests:
          - type:
              type: 'double precision'
      - name: absolute_gain_1w
        tests:
          - type:
              type: 'double precision'
      - name: absolute_gain_1m
        tests:
          - type:
              type: 'double precision'
      - name: absolute_gain_3m
        tests:
          - type:
              type: 'double precision'
      - name: absolute_gain_1y
        tests:
          - type:
              type: 'double precision'
      - name: absolute_gain_5y
        tests:
          - type:
              type: 'double precision'
      - name: absolute_gain_total
        tests:
          - type:
              type: 'double precision'
      - name: ltt_quantity_total
        tests:
          - type:
              type: 'double precision'

  - name: portfolio_holding_details
    columns:
      - name: holding_id
        tests:
          - type:
              type: 'text'
      - name: ticker_symbol
        tests:
          - type:
              type: 'character varying'
      - name: account_id
        tests:
          - type:
              type: 'integer'
      - name: purchase_date
        tests:
          - type:
              type: 'timestamp without time zone'
      - name: relative_gain_total
        tests:
          - type:
              type: 'double precision'
      - name: relative_gain_1d
        tests:
          - type:
              type: 'double precision'
      - name: value_to_portfolio_value
        tests:
          - type:
              type: 'double precision'
      - name: ticker_name
        tests:
          - type:
              type: 'text'
      - name: market_capitalization
        tests:
          - type:
              type: 'bigint'
      - name: next_earnings_date
        tests:
          - type:
              type: 'timestamp without time zone'
      - name: security_type
        tests:
          - type:
              type: 'character varying'
      - name: ltt_quantity_total
        tests:
          - type:
              type: 'double precision'
      - name: name
        tests:
          - type:
              type: 'character varying'
      - name: quantity
        tests:
          - type:
              type: 'double precision'
      - name: avg_cost
        tests:
          - type:
              type: 'double precision'

  - name: portfolio_holding_group_details
    columns:
      - name: id
        tests:
          - type:
              type: 'text'
      - name: profile_id
        tests:
          - type:
              type: 'integer'
      - name: ticker_symbol
        tests:
          - type:
              type: 'character varying'
      - name: purchase_date
        tests:
          - type:
              type: 'timestamp without time zone'
      - name: relative_gain_total
        tests:
          - type:
              type: 'double precision'
      - name: relative_gain_1d
        tests:
          - type:
              type: 'double precision'
      - name: value_to_portfolio_value
        tests:
          - type:
              type: 'double precision'
      - name: ticker_name
        tests:
          - type:
              type: 'text'
      - name: market_capitalization
        tests:
          - type:
              type: 'bigint'
      - name: next_earnings_date
        tests:
          - type:
              type: 'timestamp without time zone'
      - name: updated_at
        tests:
          - type:
              type: 'timestamp with time zone'
      - name: ltt_quantity_total
        tests:
          - type:
              type: 'double precision'


  - name: portfolio_gains
    columns:
      - name: profile_id
        tests:
          - type:
              type: 'integer'
      - name: actual_value
        tests:
          - type:
              type: 'double precision'
      - name: updated_at
        tests:
          - type:
              type: 'timestamp with time zone'
      - name: relative_gain_1d
        tests:
          - type:
              type: 'double precision'
      - name: relative_gain_1w
        tests:
          - type:
              type: 'double precision'
      - name: relative_gain_1m
        tests:
          - type:
              type: 'double precision'
      - name: relative_gain_3m
        tests:
          - type:
              type: 'double precision'
      - name: relative_gain_1y
        tests:
          - type:
              type: 'double precision'
      - name: relative_gain_5y
        tests:
          - type:
              type: 'double precision'
      - name: relative_gain_total
        tests:
          - type:
              type: 'double precision'
      - name: absolute_gain_1d
        tests:
          - type:
              type: 'double precision'
      - name: absolute_gain_1w
        tests:
          - type:
              type: 'double precision'
      - name: absolute_gain_1m
        tests:
          - type:
              type: 'double precision'
      - name: absolute_gain_3m
        tests:
          - type:
              type: 'double precision'
      - name: absolute_gain_1y
        tests:
          - type:
              type: 'double precision'
      - name: absolute_gain_5y
        tests:
          - type:
              type: 'double precision'
      - name: absolute_gain_total
        tests:
          - type:
              type: 'double precision'

  - name: portfolio_transaction_chart
    columns:
      - name: id
        tests:
          - type:
              type: 'text'
      - name: transactions_uniq_id
        tests:
          - type:
              type: 'character varying'
      - name: datetime
        tests:
          - type:
              type: 'timestamp without time zone'
      - name: period
        tests:
          - type:
              type: 'character varying'
      - name: open
        tests:
          - type:
              type: 'double precision'
      - name: high
        tests:
          - type:
              type: 'double precision'
      - name: low
        tests:
          - type:
              type: 'double precision'
      - name: close
        tests:
          - type:
              type: 'double precision'
      - name: adjusted_close
        tests:
          - type:
              type: 'double precision'
      - name: transactions_updated_at
        tests:
          - type:
              type: 'timestamp with time zone'

  - name: ticker_realtime_metrics
    columns:
      - name: symbol
        tests:
          - type:
              type: 'character varying'
      - name: time
        tests:
          - type:
              type: 'timestamp without time zone'
      - name: actual_price
        tests:
          - type:
              type: 'double precision'
      - name: absolute_daily_change
        tests:
          - type:
              type: 'double precision'
      - name: relative_daily_change
        tests:
          - type:
              type: 'double precision'
      - name: daily_volume
        tests:
          - type:
              type: 'double precision'
      - name: last_known_price
        tests:
          - type:
              type: 'double precision'
      - name: last_known_price_datetime
        tests:
          - type:
              type: 'timestamp without time zone'
      - name: previous_day_close_price
        tests:
          - type:
              type: 'double precision'

  - name: profile_collections
    columns:
      - name: uniq_id
        tests:
          - type:
              type: 'character varying'
      - name: profile_id
        tests:
          - type:
              type: 'integer'
      - name: id
        tests:
          - type:
              type: 'integer'
      - name: name
        tests:
          - type:
              type: 'character varying'
      - name: description
        tests:
          - type:
              type: 'character varying'
      - name: image_url
        tests:
          - type:
              type: 'character varying'
      - name: enabled
        tests:
          - type:
              type: 'text'
      - name: personalized
        tests:
          - type:
              type: 'character varying'
      - name: size
        tests:
          - type:
              type: 'integer'

  - name: collection_metrics
    columns:
      - name: profile_id
        tests:
          - type:
              type: 'integer'
      - name: collection_uniq_id
        tests:
          - type:
              type: 'text'
      - name: actual_price
        tests:
          - type:
              type: 'double precision'
      - name: absolute_daily_change
        tests:
          - type:
              type: 'double precision'
      - name: relative_daily_change
        tests:
          - type:
              type: 'double precision'
      - name: previous_day_close_price
        tests:
          - type:
              type: 'double precision'
      - name: market_capitalization_sum
        tests:
          - type:
              type: 'bigint'
      - name: updated_at
        tests:
          - type:
              type: 'timestamp with time zone'

  - name: profile_collection_tickers_performance_ranked
    columns:
      - name: profile_id
        tests:
          - type:
              type: 'integer'
      - name: symbol
        tests:
          - type:
              type: 'character varying'
      - name: relative_daily_change
        tests:
          - type:
              type: 'double precision'
      - name: updated_at
        tests:
          - type:
              type: 'timestamp without time zone'
      - name: gainer_rank
        tests:
          - type:
              type: 'integer'
      - name: loser_rank
        tests:
          - type:
              type: 'integer'

  - name: website_blog_articles
    columns:
      - name: id
        tests:
          - type:
              type: 'character varying'
      - name: title
        tests:
          - type:
              type: 'character varying'
      - name: post_summary
        tests:
          - type:
              type: 'character varying'
      - name: main_image
        tests:
          - type:
              type: 'character varying'
      - name: category_link
        tests:
          - type:
              type: 'character varying'
      - name: category_name
        tests:
          - type:
              type: 'character varying'
      - name: published_on
        tests:
          - type:
              type: 'timestamp without time zone'
      - name: rate_rating
        tests:
          - type:
              type: 'double precision'
      - name: rate_votes
        tests:
          - type:
              type: 'double precision'
      - name: url
        tests:
          - type:
              type: 'text'
      - name: updated_on
        tests:
          - type:
              type: 'timestamp without time zone'
      - name: priority
        tests:
          - type:
              type: 'integer'

  - name: collection_chart
    columns:
      - name: profile_id
        tests:
          - type:
              type: 'integer'
      - name: collection_id
        tests:
          - type:
              type: 'integer'
      - name: collection_uniq_id
        tests:
          - type:
              type: 'text'
      - name: datetime
        tests:
          - type:
              type: 'timestamp without time zone'
      - name: period
        tests:
          - type:
              type: 'text'
      - name: open
        tests:
          - type:
              type: 'double precision'
      - name: high
        tests:
          - type:
              type: 'double precision'
      - name: low
        tests:
          - type:
              type: 'double precision'
      - name: close
        tests:
          - type:
              type: 'double precision'
      - name: adjusted_close
        tests:
          - type:
              type: 'double precision'

  - name: collection_piechart
    columns:
      - name: profile_id
        tests:
          - type:
              type: 'integer'
      - name: collection_id
        tests:
          - type:
              type: 'integer'
      - name: collection_uniq_id
        tests:
          - type:
              type: 'text'
      - name: weight
        tests:
          - type:
              type: 'double precision'
      - name: entity_type
        tests:
          - type:
              type: 'character varying'
      - name: entity_id
        tests:
          - type:
              type: 'character varying'
      - name: entity_name
        tests:
          - type:
              type: 'character varying'
      - name: absolute_daily_change
        tests:
          - type:
              type: 'double precision'
      - name: relative_daily_change
        tests:
          - type:
              type: 'double precision'
      - name: absolute_value
        tests:
          - type:
              type: 'double precision'

  - name: collection_match_score
    columns:
      - name: profile_id
        tests:
          - type:
              type: 'integer'
      - name: collection_id
        tests:
          - type:
              type: 'integer'
      - name: collection_uniq_id
        tests:
          - type:
              type: 'text'
      - name: match_score
        tests:
          - type:
              type: 'double precision'
      - name: risk_level
        tests:
          - type:
              type: 'integer'
      - name: risk_similarity
        tests:
          - type:
              type: 'double precision'
      - name: category_level
        tests:
          - type:
              type: 'integer'
      - name: category_similarity
        tests:
          - type:
              type: 'double precision'
      - name: interest_level
        tests:
          - type:
              type: 'integer'
      - name: interest_similarity
        tests:
          - type:
              type: 'double precision'

  - name: collection_match_score_explanation
    columns:
      - name: profile_id
        tests:
          - type:
              type: 'integer'
      - name: collection_id
        tests:
          - type:
              type: 'integer'
      - name: collection_uniq_id
        tests:
          - type:
              type: 'text'
      - name: category_id
        tests:
          - type:
              type: 'integer'
      - name: interest_id
        tests:
          - type:
              type: 'integer'
      - name: user_id
        tests:
          - type:
              type: 'text'

  - name: crypto_metrics
    columns:
      - name: symbol
        tests:
          - type:
              type: 'character varying'
      - name: country_origin
        tests:
          - type:
              type: 'character varying'
      - name: categories
        tests:
          - type:
              type: 'jsonb'
      - name: asset_platform_id
        tests:
          - type:
              type: 'character varying'
      - name: hashing_algorithm
        tests:
          - type:
              type: 'character varying'
      - name: links
        tests:
          - type:
              type: 'jsonb'
      - name: market_cap_rank
        tests:
          - type:
              type: 'integer'
      - name: coingecko_rank
        tests:
          - type:
              type: 'integer'
      - name: coingecko_score
        tests:
          - type:
              type: 'double precision'
      - name: public_interest_score
        tests:
          - type:
              type: 'double precision'
      - name: alexa_rank
        tests:
          - type:
              type: 'integer'
      - name: bing_matches
        tests:
          - type:
              type: 'integer'
      - name: liquidity_score
        tests:
          - type:
              type: 'double precision'
      - name: sentiment_votes_up_percentage
        tests:
          - type:
              type: 'double precision'
      - name: sentiment_votes_down_percentage
        tests:
          - type:
              type: 'double precision'
      - name: ico_start_date
        tests:
          - type:
              type: 'date'
      - name: ico_end_date
        tests:
          - type:
              type: 'date'
      - name: image_large
        tests:
          - type:
              type: 'character varying'
      - name: image_small
        tests:
          - type:
              type: 'character varying'
      - name: image_thumb
        tests:
          - type:
              type: 'character varying'
      - name: community_score
        tests:
          - type:
              type: 'double precision'
      - name: community_facebook_likes
        tests:
          - type:
              type: 'integer'
      - name: community_twitter_followers
        tests:
          - type:
              type: 'integer'
      - name: community_reddit_subscribers
        tests:
          - type:
              type: 'integer'
      - name: community_reddit_average_posts_48h
        tests:
          - type:
              type: 'double precision'
      - name: community_reddit_accounts_active_48h
        tests:
          - type:
              type: 'integer'
      - name: community_reddit_average_comments_48h
        tests:
          - type:
              type: 'double precision'
      - name: community_telegram_channel_user_count
        tests:
          - type:
              type: 'integer'
      - name: development_score
        tests:
          - type:
              type: 'double precision'
      - name: development_forks
        tests:
          - type:
              type: 'integer'
      - name: development_stars
        tests:
          - type:
              type: 'integer'
      - name: development_subscribers
        tests:
          - type:
              type: 'integer'
      - name: development_total_issues
        tests:
          - type:
              type: 'integer'
      - name: development_closed_issues
        tests:
          - type:
              type: 'integer'
      - name: development_commit_count_4_weeks
        tests:
          - type:
              type: 'integer'
      - name: development_pull_requests_merged
        tests:
          - type:
              type: 'integer'
      - name: development_pull_request_contributors
        tests:
          - type:
              type: 'integer'
      - name: development_code_additions_deletions_4_weeks_additions
        tests:
          - type:
              type: 'integer'
      - name: development_code_additions_deletions_4_weeks_deletions
        tests:
          - type:
              type: 'integer'
      - name: market_mcap_to_tvl_ratio
        tests:
          - type:
              type: 'double precision'
      - name: market_fdv_to_tvl_ratio
        tests:
          - type:
              type: 'double precision'
      - name: market_total_value_locked
        tests:
          - type:
              type: 'double precision'
      - name: price_change_1w
        tests:
          - type:
              type: 'double precision'
      - name: price_change_1m
        tests:
          - type:
              type: 'double precision'
      - name: price_change_3m
        tests:
          - type:
              type: 'double precision'
      - name: price_change_1y
        tests:
          - type:
              type: 'double precision'
      - name: price_change_5y
        tests:
          - type:
              type: 'double precision'
      - name: price_change_all
        tests:
          - type:
              type: 'double precision'

  - name: crypto_realtime_metrics
    columns:
      - name: symbol
        tests:
          - type:
              type: 'character varying'
      - name: ath
        tests:
          - type:
              type: 'double precision'
      - name: atl
        tests:
          - type:
              type: 'double precision'
      - name: market_capitalization
        tests:
          - type:
              type: 'double precision'
      - name: circulating_supply
        tests:
          - type:
              type: 'double precision'
      - name: max_supply
        tests:
          - type:
              type: 'double precision'
      - name: total_supply
        tests:
          - type:
              type: 'double precision'
      - name: volume_24h
        tests:
          - type:
              type: 'double precision'
      - name: high_24h
        tests:
          - type:
              type: 'double precision'
      - name: low_24h
        tests:
          - type:
              type: 'double precision'

  - name: ticker_options_monitored
    columns:
      - name: contract_name
        tests:
          - type:
              type: 'character varying'
      - name: symbol
        tests:
          - type:
              type: 'character varying'

  - name: profile_holdings_normalized
    columns:
      - name: holding_id
        tests:
          - type:
              type: 'text'
      - name: plaid_access_token_id
        tests:
          - type:
              type: 'integer'
      - name: security_id
        tests:
          - type:
              type: 'integer'
      - name: profile_id
        tests:
          - type:
              type: 'integer'
      - name: account_id
        tests:
          - type:
              type: 'integer'
      - name: quantity
        tests:
          - type:
              type: 'double precision'
      - name: quantity_norm_for_valuation
        tests:
          - type:
              type: 'double precision'
      - name: name
        tests:
          - type:
              type: 'character varying'
      - name: ticker_symbol
        tests:
          - type:
              type: 'character varying'
      - name: type
        tests:
          - type:
              type: 'character varying'

  - name: portfolio_expanded_transactions
    columns:
      - name: amount
        tests:
          - type:
              type: 'double precision'
      - name: price
        tests:
          - type:
              type: 'double precision'
      - name: quantity
        tests:
          - type:
              type: 'numeric'
      - name: security_id
        tests:
          - type:
              type: 'integer'
      - name: profile_id
        tests:
          - type:
              type: 'integer'
      - name: account_id
        tests:
          - type:
              type: 'integer'
      - name: quantity_norm
        tests:
          - type:
              type: 'numeric'
      - name: quantity_norm_for_valuation
        tests:
          - type:
              type: 'numeric'
      - name: updated_at
        tests:
          - type:
              type: 'timestamp with time zone'
      - name: last_seen_at
        tests:
          - type:
              type: 'timestamp with time zone'
      - name: uniq_id
        tests:
          - type:
              type: 'character varying'
      - name: date
        tests:
          - type:
              type: 'date'

  - name: push_notifications
    columns:
      - name: profile_id
        tests:
          - type:
              type: 'integer'
      - name: uniq_id
        tests:
          - unique
          - not_null
          - type:
              type: 'text'
      - name: send_at
        tests:
          - type:
              type: 'timestamp with time zone'
      - name: text
        tests:
          - type:
              type: 'json'
      - name: data
        tests:
          - type:
              type: 'json'
      - name: is_test
        tests:
          - type:
              type: 'boolean'
      - name: template_id
        tests:
          - type:
              type: 'text'

  - name: data_checks
    columns:
      - name: id
        tests:
          - type:
              type: 'text'
      - name: symbol
        tests:
          - type:
              type: 'character varying'
      - name: code
        tests:
          - type:
              type: 'text'
      - name: period
        tests:
          - type:
              type: 'text'
      - name: message
        tests:
          - type:
              type: 'text'
      - name: updated_at
        tests:
          - type:
              type: 'timestamp with time zone'

  - name: collection_ticker_weights
    columns:
      - name: date
        tests:
          - type:
              type: 'date'
      - name: profile_id
        tests:
          - type:
              type: 'integer'
      - name: collection_id
        tests:
          - type:
              type: 'integer'
      - name: collection_uniq_id
        tests:
          - type:
              type: 'text'
      - name: symbol
        tests:
          - type:
              type: 'character varying'
      - name: weight
        tests:
          - type:
              type: 'numeric'
      - name: price
        tests:
          - type:
              type: 'numeric'

  - name: collection_historical_values
    columns:
      - name: collection_uniq_id
        tests:
          - type:
              type: 'text'
      - name: date
        tests:
          - type:
              type: 'date'
      - name: value
        tests:
          - type:
              type: 'numeric'
      - name: id
        tests:
          - type:
              type: 'text'
      - name: updated_at
        tests:
          - type:
              type: 'timestamp with time zone'

  - name: portfolio_holding_group_tags
    columns:
      - name: profile_id
        tests:
          - type:
              type: 'integer'
      - name: symbol
        tests:
          - type:
              type: 'character varying'
      - name: collection_id
        tests:
          - type:
              type: 'integer'
      - name: collection_uniq_id
        tests:
          - type:
              type: 'text'
      - name: category_id
        tests:
          - type:
              type: 'integer'
      - name: interest_id
        tests:
          - type:
              type: 'integer'
      - name: priority
        tests:
          - type:
              type: 'integer'
      - name: updated_at
        tests:
          - type:
              type: 'timestamp with time zone'
      - name: id
        tests:
          - type:
              type: 'text'
      - name: is_realtime
        tests:
          - type:
              type: 'boolean'

  - name: historical_intraday_prices
    columns:
      - name: symbol
        tests:
          - type:
              type: 'character varying'
      - name: date
        tests:
          - type:
              type: 'date'
      - name: time
        tests:
          - type:
              type: 'timestamp without time zone'
      - name: time_3min
        tests:
          - type:
              type: 'timestamp without time zone'
      - name: time_15min
        tests:
          - type:
              type: 'timestamp without time zone'
      - name: open
        tests:
          - type:
              type: 'double precision'
      - name: high
        tests:
          - type:
              type: 'double precision'
      - name: low
        tests:
          - type:
              type: 'double precision'
      - name: close
        tests:
          - type:
              type: 'double precision'
      - name: volume
        tests:
          - type:
              type: 'double precision'
      - name: adjusted_close
        tests:
          - type:
              type: 'double precision'
      - name: updated_at
        tests:
          - type:
              type: 'timestamp without time zone'
      - name: id
        tests:
          - type:
              type: 'text'

  - name: historical_prices_aggregated_3min
    columns:
      - name: id
        tests:
          - type:
              type: 'text'
      - name: symbol
        tests:
          - type:
              type: 'character varying'
      - name: datetime
        tests:
          - type:
              type: 'timestamp without time zone'
      - name: open
        tests:
          - type:
              type: 'double precision'
      - name: high
        tests:
          - type:
              type: 'double precision'
      - name: low
        tests:
          - type:
              type: 'double precision'
      - name: close
        tests:
          - type:
              type: 'double precision'
      - name: volume
        tests:
          - type:
              type: 'double precision'
      - name: adjusted_close
        tests:
          - type:
              type: 'double precision'
      - name: updated_at
        tests:
          - type:
              type: 'timestamp without time zone'

  - name: historical_prices_aggregated_15min
    columns:
      - name: id
        tests:
          - type:
              type: 'text'
      - name: symbol
        tests:
          - type:
              type: 'character varying'
      - name: datetime
        tests:
          - type:
              type: 'timestamp without time zone'
      - name: open
        tests:
          - type:
              type: 'double precision'
      - name: high
        tests:
          - type:
              type: 'double precision'
      - name: low
        tests:
          - type:
              type: 'double precision'
      - name: close
        tests:
          - type:
              type: 'double precision'
      - name: volume
        tests:
          - type:
              type: 'double precision'
      - name: adjusted_close
        tests:
          - type:
              type: 'double precision'
      - name: updated_at
        tests:
          - type:
              type: 'timestamp without time zone'

  - name: deployment_metadata
    columns:
      - name: id
        tests:
          - type:
              type: 'integer'
      - name: last_activity_at
        tests:
          - type:
              type: 'timestamp with time zone'

  - name: week_trading_sessions
    columns:
      - name: updated_at
        tests:
          - type:
              type: 'timestamp with time zone'
      - name: id
        tests:
          - type:
              type: 'text'
      - name: symbol
        tests:
          - type:
              type: 'character varying'
      - name: date
        tests:
          - type:
              type: 'date'
      - name: index
        tests:
          - type:
              type: 'integer'
      - name: open_at
        tests:
          - type:
              type: 'timestamp with time zone'
      - name: close_at
        tests:
          - type:
              type: 'timestamp with time zone'

  - name: portfolio_securities_normalized
    columns:
      - name: id
        tests:
          - type:
              type: 'integer'
      - name: name
        tests:
          - type:
              type: 'character varying'
      - name: ticker_symbol
        tests:
          - type:
              type: 'character varying'
      - name: original_ticker_symbol
        tests:
          - type:
              type: 'character varying'
      - name: type
        tests:
          - type:
              type: 'character varying'

  - name: etf_metrics
    columns:
      - name: symbol
        tests:
          - type:
              type: 'character varying'
      - name: volatility_1y
        tests:
          - type:
              type: 'double precision'
      - name: volatility_3y
        tests:
          - type:
              type: 'double precision'
      - name: dividend_frequency
        tests:
          - type:
              type: 'text'
      - name: net_expense_ratio
        tests:
          - type:
              type: 'double precision'
      - name: total_assets
        tests:
          - type:
              type: 'bigint'
      - name: annualized_return_5y
        tests:
          - type:
              type: 'double precision'
      - name: min_annual_return
        tests:
          - type:
              type: 'double precision'
      - name: max_annual_return
        tests:
          - type:
              type: 'double precision'

exposures:
  - name: ticker_search_index
    type: application
    description: Ticker search index in Algolia
    depends_on:
      - ref('ticker_search')
    owner:
      name: Vasilii Khomutov
      email: vasilii@gainy.app

  - name: collection_search_index
    type: application
    description: Collection search index in Algolia
    depends_on:
      - ref('collection_search')
    owner:
      name: Vasilii Khomutov
      email: vasilii@gainy.app
